#!/usr/bin/env python3
import json
from jwcrypto import jwk, jwt


with open("keypair.pem", "rb") as pemfile:
        key = jwk.JWK.from_pem(pemfile.read())

publickey = key.export(private_key=False) 



jwks = {}
jwks["keys"] = [json.loads(publickey)] 

with open("jwks.json","w") as h:
    h.write(json.dumps(jwks))


Token = jwt.JWT(header={"alg": "RS256",
                        "typ": "JWT",
                        "kid": key.key_id,
                        "jku": "https://mif.vu.lt/~edsa6402/jwks.json"
                        },
               claims={"hasInvitation": "true",
                       "tweeterID": "c5570414d2cfdba11ff3768f209547ca53d249c4cf60cfc3ffcdaf986114a693",
                       "iat": 1656755440})

Token.make_signed_token(key)
print(Token)